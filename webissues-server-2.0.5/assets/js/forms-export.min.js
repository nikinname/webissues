/*!
 * WebIssues v2.0.5
 * Copyright (C) 2007-2020 WebIssues Team
 * License: Affero GPL v3.0
 */
(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{167:function(e,t,o){"use strict";o.r(t);var r=o(86),n=o(90),i=o.n(n),a=o(85);function s(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)}return o}function l(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?s(Object(o),!0).forEach((function(t){c(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):s(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function c(e,t,o){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var r=o.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var u={fields:()=>({exportType:{value:0,type:Number},delimiter:{value:",",type:String}}),computed:l(l({},Object(r.b)("list",["type"])),{},{size(){return null!=this.type?"normal":"small"}}),methods:{submit(){null!=this.type?this.$fields.validate()&&(this.$form.block(),this.$store.dispatch("list/export",{allColumns:1==this.exportType}).then(e=>{let{columns:t,issues:o}=e;const r=this.generateCSV(t,o),n=new Blob(r,{type:"text/csv; charset=UTF-8"});i.a.saveAs(n,"WebIssues.csv"),this.$form.close()}).catch(e=>{this.$form.error(e)})):this.$form.close()},cancel(){this.$form.close()},generateCSV(e,t){const o=e.map(e=>e.id>a.e.UserDefined&&null!=this.type?this.type.attributes.find(t=>t.id==e.id-a.e.UserDefined):null),r=[String.fromCharCode(65279)];r.push(e.map(e=>e.name).map(this.escapeCSV).join(this.delimiter)),r.push("\r\n");for(const n in t)r.push(t[n].cells.map((t,r)=>{const n=e[r].id;return n==a.e.ModifiedDate||n==a.e.CreatedDate?this.$formatter.formatStamp(t):""!=t&&null!=o[r]?this.$formatter.convertAttributeValue(t,o[r]):t}).map(this.escapeCSV).join(this.delimiter)),r.push("\r\n");return r},escapeCSV(e){return""==e?e:e.startsWith(" ")||e.endsWith(" ")||e.includes('"')||e.includes(this.delimiter)||e.includes("\n")||"ID"==e?'"'+e.replace(/"/g,'""')+'"':e}}},p=o(84),d=Object(p.a)(u,(function(){var e=this,t=e._self._c;return t("BaseForm",{attrs:{title:e.$t("cmd.ExportToCSV"),size:e.size,"with-buttons":"","cancel-hidden":null==e.type},on:{ok:e.submit,cancel:e.cancel}},[null!=e.type?t("Prompt",{attrs:{path:"prompt.ExportToCSV"}}):t("Prompt",{attrs:{"alert-class":"alert-warning",path:"prompt.NoTypeSelected"}}),e._v(" "),null!=e.type?t("FormGroup",{attrs:{label:e.$t("label.Type"),required:""}},[t("div",{staticClass:"radio"},[t("label",[t("input",{directives:[{name:"model",rawName:"v-model",value:e.exportType,expression:"exportType"}],attrs:{type:"radio"},domProps:{value:0,checked:e._q(e.exportType,0)},on:{change:function(t){e.exportType=0}}}),e._v(" "+e._s(e.$t("text.TableWithVisibleColumns")))])]),e._v(" "),t("div",{staticClass:"radio"},[t("label",[t("input",{directives:[{name:"model",rawName:"v-model",value:e.exportType,expression:"exportType"}],attrs:{type:"radio"},domProps:{value:1,checked:e._q(e.exportType,1)},on:{change:function(t){e.exportType=1}}}),e._v(" "+e._s(e.$t("text.TableWithAllColumns")))])])]):e._e(),e._v(" "),null!=e.type?t("FormGroup",{attrs:{label:e.$t("label.Delimiter"),required:""}},[t("div",{staticClass:"radio"},[t("label",[t("input",{directives:[{name:"model",rawName:"v-model",value:e.delimiter,expression:"delimiter"}],attrs:{type:"radio",value:","},domProps:{checked:e._q(e.delimiter,",")},on:{change:function(t){e.delimiter=","}}}),e._v(" "+e._s(e.$t("text.Comma")))])]),e._v(" "),t("div",{staticClass:"radio"},[t("label",[t("input",{directives:[{name:"model",rawName:"v-model",value:e.delimiter,expression:"delimiter"}],attrs:{type:"radio",value:";"},domProps:{checked:e._q(e.delimiter,";")},on:{change:function(t){e.delimiter=";"}}}),e._v(" "+e._s(e.$t("text.Semicolon")))])])]):e._e()],1)}),[],!1,null,null,null);t.default=d.exports},90:function(e,t,o){(function(o){var r,n,i;n=[],void 0===(i="function"==typeof(r=function(){"use strict";function t(e,t,o){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){s(r.response,t,o)},r.onerror=function(){console.error("could not download file")},r.send()}function r(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function n(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(o){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var i="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof o&&o.global===o?o:void 0,a=i.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),s=i.saveAs||("object"!=typeof window||window!==i?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(e,o,a){var s=i.URL||i.webkitURL,l=document.createElement("a");o=o||e.name||"download",l.download=o,l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?n(l):r(l.href)?t(e,o,a):n(l,l.target="_blank")):(l.href=s.createObjectURL(e),setTimeout((function(){s.revokeObjectURL(l.href)}),4e4),setTimeout((function(){n(l)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,o,i){if(o=o||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}(e,i),o);else if(r(e))t(e,o,i);else{var a=document.createElement("a");a.href=e,a.target="_blank",setTimeout((function(){n(a)}))}}:function(e,o,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof e)return t(e,o,r);var s="application/octet-stream"===e.type,l=/constructor/i.test(i.HTMLElement)||i.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||s&&l||a)&&"undefined"!=typeof FileReader){var u=new FileReader;u.onloadend=function(){var e=u.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=e:location=e,n=null},u.readAsDataURL(e)}else{var p=i.URL||i.webkitURL,d=p.createObjectURL(e);n?n.location=d:location.href=d,n=null,setTimeout((function(){p.revokeObjectURL(d)}),4e4)}});i.saveAs=s.saveAs=s,e.exports=s})?r.apply(t,n):r)||(e.exports=i)}).call(this,o(37))}}]);