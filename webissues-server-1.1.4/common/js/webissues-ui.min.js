/*! Copyright (C) 2007-2015 WebIssues Team | License: AGPLv3 */
!function(e){e.datepicker._gotoToday=function(t){var n=e(t),o=this._getInst(n[0]);this._selectDate(t,this._get(o,"currentValue"))},e.datepicker._updateDatepickerOrig=e.datepicker._updateDatepicker,e.datepicker._updateDatepicker=function(e){this._updateDatepickerOrig(e),e.dpDiv.find(".ui-datepicker-current").removeClass("ui-priority-secondary").addClass("ui-priority-primary")},e.widget("ui.datetimepicker",{options:{withTime:!1,zeroTime:""},_create:function(){var e=this,t=" "+e.options.zeroTime;e.element.datepicker({showOn:"button",buttonText:e.options.buttonText,buttonImage:e.options.buttonImage,buttonImageOnly:!0,showAnim:"",monthNamesShort:e.options.monthNamesShort,dayNames:e.options.dayNames,dayNamesMin:e.options.dayNamesMin,firstDay:e.options.firstDay,nextText:e.options.nextText,prevText:e.options.prevText,currentText:e.options.currentText,currentValue:e.options.currentValue,closeText:e.options.closeText,changeMonth:!0,changeYear:!0,dateFormat:e.options.dateFormat,constrainInput:e.options.constrainInput,showButtonPanel:!0,showOtherMonths:!0,selectOtherMonths:!0,beforeShow:function(n){e.options.withTime&&0!=n.value.length&&(pos=n.value.indexOf(" "))>=0&&(t=n.value.substring(pos))},onSelect:function(){e.options.withTime&&0!=this.value.length&&"["!=this.value[0]&&this.value.indexOf(" ")<0&&(this.value+=t)}})}}),e.widget("ui.autocompletebutton",{options:{minLength:0,multiSelect:!1},_create:function(){var t=this;t.element.bind("keydown",function(t){t.keyCode===e.ui.keyCode.TAB&&e(this).data("ui-autocomplete").menu.active&&t.preventDefault()}),t.element.autocomplete({minLength:t.options.minLength,source:function(n,o){var i=n.term;t.options.multiSelect&&(i=i.split(/,\s*/).pop());var a=new RegExp("^"+e.ui.autocomplete.escapeRegex(i),"i");o(e.grep(t.options.source,function(e){return a.test(e.label||e.value||e)}))},focus:function(e,n){if(!t.options.multiSelect)return!0;if(/^key/.test(e.originalEvent.originalEvent.type)){var o=this.value.split(/,\s*/);o.pop(),o.push(n.item.value),this.value=o.join(", ")}return!1},select:function(e,n){if(!t.options.multiSelect)return!0;var o=this.value.split(/,\s*/);return o.pop(),o.push(n.item.value),this.value=o.join(", "),!1}});var n=t.options.buttonImage,o=t.options.buttonText,i=e('<img src="'+n+'" alt="'+o+'" title="'+o+'" class="ui-autocomplete-trigger" />');t.element.after(i),i.click(function(){return t.element.autocomplete("widget").is(":visible")?t.element.autocomplete("close"):(t.element.autocomplete("search",""),t.element.focus()),!1})}}),e.widget("ui.searchoptions",{options:{},_create:function(){var t=this,n=t.options.buttonImage,o=t.options.buttonText,a=e('<img src="'+n+'" alt="'+o+'" title="'+o+'" class="icon" />');t.element.parent().before(a);var s=e(t.options.hiddenField),u=s.val(),r=e('<span class="input-prompt"></span>');for(i in t.options.source){var l=t.options.source[i];l.value==u&&r.text(l.label)}""!=t.element.val()&&r.hide(),t.element.before(r);var c=!1;t.element.autocomplete({minLength:0,position:{of:a},source:function(e,n){n(t.options.source)},search:function(){return c},close:function(){c=!1},focus:function(){return!1},select:function(e,t){return u=t.item.value,s.val(u),r.text(t.item.label),!1}}),t.element.data("ui-autocomplete")._renderItem=function(t,n){var o=e("<a></a>");return n.value==u?o.append(e("<strong></strong>").text(n.label)):o.text(n.label),e("<li></li>").data("ui-autocomplete-item",n).append(o).appendTo(t)},a.click(function(){c=!0,t.element.autocomplete("search",""),t.element.focus()}),r.click(function(){r.hide(),t.element.focus()}),t.element.focus(function(){r.hide()}),t.element.blur(function(){""==t.element.val()&&r.attr("style","display:inline")})}})}(jQuery);