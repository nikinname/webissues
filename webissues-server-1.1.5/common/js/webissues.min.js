/*! Copyright (C) 2007-2017 WebIssues Team | License: AGPLv3 */
var WebIssues=WebIssues||{};!function(n,e){n.classParam=function(n,e){var t=n.attr("class").split(" ");for(i in t)if(t[i].substring(0,e.length+1)==e+"-")return t[i].substring(e.length+1);return""},n.autofocus=function(){var i=e("form:not(.form-inline)");if(i.length>0){var n=[],t=i.find(".error");t.length>0&&(n=t.prev(":input"),0==n.length&&(n=t.prevAll(".form-field:first").children(":input")));var r=[];r=n.length>0?n:i.find(":input:enabled"),r.each(function(){return e(this).is(":text,:password,:radio:checked,:checkbox,select,textarea")?(this.focus(),!1):void 0})}},n.autoalign=function(){var i=e(".info-align");if(i.length>0){var n=0;i.each(function(){var i=e(this).find("td").first().width();i>n&&(n=i)}),i.each(function(){e(this).find("td").first().css("width",Math.ceil(n))})}},n.switchClient=function(i,n){e(".switch-client").click(function(){e.cookie("wi_client",i,n)})},n.expandCookie=function(t,r){var a=[],s=e.cookie(t);s&&(a=s.split("|")),e(".expand").show(),e(".blank").show(),e(".collapse").hide(),e(".child").hide();for(i in a)a[i].length>0&&(e(".child.parent-"+a[i]).show(),e(".parent.parent-"+a[i]+" .collapse").show(),e(".parent.parent-"+a[i]+" .expand").hide());e(".expand, .collapse").click(function(){var s=n.classParam(e(this).parents("tr"),"parent");e(".child.parent-"+s).toggle(),e(this).hide();var o=[],c=0;if(e(this).hasClass("expand")){e(".parent.parent-"+s+" .collapse").show();var l=!1;for(i in a)a[i].length>0&&(a[i]==s&&(l=!0),o[c]=a[i],c++);l||(o[c]=s)}else{e(".parent.parent-"+s+" .expand").show();for(i in a)a[i].length>0&&a[i]!=s&&(o[c]=a[i],c++)}return a=o,e.cookie(t,a.join("|"),r),!1})},n.deparam=function(i){var n={},e=i.split("&");for(var t in e){var r=e[t].split("=");n[r[0]]=r[1]}return n},n.sortByKey=function(i){var n=[];for(var e in i)n.push(e);n.sort();var t={};for(var e in n)t[n[e]]=i[n[e]];return t},n.mergeQueryString=function(i,t){var r={},a=i.split("?");void 0!=a[1]&&(r=n.deparam(a[1])),e.extend(r,n.deparam(t));var s=a[0];return 0!=r.length&&(s+="?"+e.param(n.sortByKey(r))),s},n.initSelection=function(t){e(".grid td a:not(.expand):not(.collapse)").click(function(){var r=e(this).parents("tr");e(".grid tr").removeClass("selected"),r.addClass("selected");for(i in t){var a=t[i],s=!0;for(j in a.conditions)r.hasClass(a.conditions[j])||(s=!1);if(s){e("#cmd-"+i).show();var o=e("#cmd-"+i+" a"),c=o.attr("href");void 0!=a.row&&(c=n.mergeQueryString(c,a.row+"="+n.classParam(r,"row"))),void 0!=a.parent&&(c=n.mergeQueryString(c,a.parent+"="+n.classParam(r,"parent"))),o.attr("href",c)}else e("#cmd-"+i).hide()}return!1})},e(function(){n.autofocus(),n.autoalign()})}(WebIssues,jQuery);